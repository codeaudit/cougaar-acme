####################################################
# Rule to insert Ammo Packer Plugins
#   at the Terminal Ammunition Packer (Currently OSC)
#   A Terminal Ammunition Packer has a role of Ammunitionprovider and a role mechanism
#     of TerminalAmmunitionPacker
#
# plugin = org.cougaar.logistics.plugin.trans.AmmoLowFidelityExpanderPlugin
# plugin = org.cougaar.logistics.plugin.packer.ALAmmoPacker
# plugin = org.cougaar.logistics.plugin.trans.AmmoProjectionExpanderPlugin
# plugin = org.cougaar.logistics.plugin.trans.Level2TranslatorPlugin(SUPPLY_TYPE=Ammunition)

ammo_low_fidelity_expander_plugin = "org.cougaar.logistics.plugin.trans.AmmoLowFidelityExpanderPlugin"
al_ammo_packer = "org.cougaar.logistics.plugin.packer.ALAmmoPacker"
ammo_projection_expander_plugin = "org.cougaar.logistics.plugin.trans.AmmoProjectionExpanderPlugin"
level2_translator_plugin = "org.cougaar.logistics.plugin.trans.Level2TranslatorPlugin"

society.each_agent do |agent|
  agent.each_facet(:role) do |facet|
    if facet[:role]=="AmmunitionProvider" && facet[:mechanism]=="TerminalAmmunitionPacker"
      agent.add_component do |c|
        c.classname = ammo_low_fidelity_expander_plugin
      end
      agent.add_component do |c|
        c.classname = al_ammo_packer
      end
      agent.add_component do |c|
        c.classname = ammo_projection_expander_plugin
      end
      agent.add_component do |c|
        c.classname = level2_translator_plugin
	c.add_argument("SUPPLY_TYPE=Ammunition")
      end
    end
  end
end
